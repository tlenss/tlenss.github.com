
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>Making permanent changes to resolv.conf under Ubuntu. - Thijs Lensselink's Blog</title>
  <meta name="author" content="Thijs Lensselink">

  
  <meta name="description" content="Making Permanent Changes to resolv.conf Under Ubuntu. At work we have a local dev box. This box is running Ubuntu 8.04 and some tools we need for &hellip;">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://tlenss.github.com/2008/11/27/making-permanent-changes-to-resolvconf-under-ubuntu/">
  <link href="/favicon.png" rel="icon">
  <link href="/stylesheets/style.css" media="screen, projection" rel="stylesheet" type="text/css">
  <script src="/javascripts/libs/jquery-1.8.1.js"></script>
  <link href="http://feeds.feedburner.com/ThijsLensselinksBlog" rel="alternate" title="Thijs Lensselink's Blog" type="application/atom+xml">
  
  
  <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-8003524-1']);
    _gaq.push(['_trackPageview']);

    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
  </script>


  <script type="text/javascript">
	$(document).ready(function() {
		$('#logo').click(function() {
			window.location = '/';
		});
	});
  </script>
</head>

<body   >
<div id="content">
	<div class="inner">
        <div>
<article class="hentry" role="article">
  
<article>
	<header>
		<header>
		
		  <h1 class="entry-title">Making Permanent Changes to resolv.conf Under Ubuntu.</h1>
		
		</header>
	</header>

	
	<div class="articletext"><p>At work we have a local dev box. This box is running <a href="http://www.ubuntu.com/">Ubuntu</a> 8.04 and some tools we need for developing. Nothing special. This box get&#8217;s it&#8217;s IP address from the <a href="http://nl.wikipedia.org/wiki/Dynamic_Host_Configuration_Protocol">DHCP</a> server that runs on the router. And this caused some problems because we are running a local <a href="http://nl.wikipedia.org/wiki/Domain_Name_System">DNS</a> server for the dev box. Mainly to use internal domains for testing.</p>

<p>To make this work we changed the resolv.conf to use the new local DNS server. This works fine wouldn&#8217;t it be for Ubuntu changing the file back to it&#8217;s original settings on every DHCP request. So every 900 sec the file gets overwritten. To solve this the first time i simply made the file read only. This however caused some problems with the DHCP client requesting an IP address over and over again. This caused the load on the dev box to rise&#8230;.</p>

<p>Further inspection showed that it&#8217;s the dhclient-script the overwrites the resolv.conf file. I tried commenting out parts of the dhclient-script. But this just created more problems. So i did a search on the Ubuntu package list. And found a promising program called <a href="http://packages.ubuntu.com/source/dapper/resolvconf">resolvconf</a>. This program takes over from resolv.conf. And with this program installed it&#8217;s possible to make permanent changes without creating any problems.</p>

<p>After installing the package and doing a search for resolvconf. I found a directory in /etc which had a resolv.conf inside. This seemed to be the template used for overwriting the original resolv.conf. After changing this file all problems were resolved.</p>

<blockquote><p>/etc/resolvconf/run/resolv.conf</p></blockquote>

<h1>Dynamic resolv.conf(5) file for glibc resolver(3) generated by resolvconf(8)</h1>

<h1>DO NOT EDIT THIS FILE BY HAND &#8211; YOUR CHANGES WILL BE OVERWRITTEN</h1>

<p>search example.com
domain example.com
nameserver xxx.xxx.x.xx</p>

<p><strong>*Update</strong></p>

<p>After googling some <a href="http://ubuntuforums.org/showthread.php?t=445753">more</a>. I think i found a better way to solve this problem. And probably the only way to solve this. No need to install any extra software. Just edit the dhclient config file.</p>

<p>change the following lines in /etc/dhcp3/dhclient.conf</p>

<blockquote><p>supersede domain-name &#8220;example.com&#8221;
prepend domain-name-server xxx.xxx.xxx.1, xxx.xxx.xxx.2</p></blockquote>
</div>
	

	<div style="clear:both;"></div>
	<footer>
		on 








  


<time datetime="2008-11-27T07:51:03+01:00" pubdate data-updated="true">Nov 27<span>th</span>, 2008</time>
		<div class="share">
			<ul>
				<li><a href="#disqus_thread">Comments</a></li>
			</ul>
		</div>
	</footer>
</article>


  <footer>
    <p class="meta">
      
  

<span class="byline author vcard">Posted by <span class="fn">Thijs Lensselink</span></span>

      








  


<time datetime="2008-11-27T07:51:03+01:00" pubdate data-updated="true">Nov 27<span>th</span>, 2008</time>
      

<span class="categories">
  
    <a class='category' href='/categories/tech/'>Tech</a>
  
</span>


    </p>
    
      <div class="sharing">
  
  <a href="http://twitter.com/share" class="twitter-share-button" data-url="http://tlenss.github.com/2008/11/27/making-permanent-changes-to-resolvconf-under-ubuntu/" data-via="tlenss" data-counturl="http://tlenss.github.com/2008/11/27/making-permanent-changes-to-resolvconf-under-ubuntu/" >Tweet</a>
  
  
  
    <div class="fb-like" data-send="true" data-width="450" data-show-faces="false"></div>
  
</div>

    
    <p class="meta">
      
        <a class="basic-alignment left" href="/2008/11/17/ubuntu-810-nvidia-driver-trickery/" title="Previous Post: Ubuntu 8.10 NVidia driver trickery">&laquo; Ubuntu 8.10 NVidia driver trickery</a>
      
      
        <a class="basic-alignment right" href="/2008/11/27/subversion-cross-platform-errors/" title="Next Post: Subversion cross platform errors">Subversion cross platform errors &raquo;</a>
      
    </p>
  </footer>
</article>

  <section>
    <h1>Comments</h1>
    <div id="disqus_thread" aria-live="polite"><noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
</div>
  </section>

</div>
	</div>
</div>

<div id="sidebar">
  
    Liquid syntax error: if tag was never closed
  
</div>

<footer role="contentinfo"><p>
  Copyright &copy; 2012 - Thijs Lensselink -
  <span class="credit">Powered by <a href="http://octopress.org">Octopress</a></span>
</p>

</footer>
  

<script type="text/javascript">
      var disqus_shortname = 'tlenss';
      
        
        // var disqus_developer = 1;
        var disqus_identifier = 'http://tlenss.github.com/2008/11/27/making-permanent-changes-to-resolvconf-under-ubuntu/';
        var disqus_url = 'http://tlenss.github.com/2008/11/27/making-permanent-changes-to-resolvconf-under-ubuntu/';
        var disqus_script = 'embed.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = 'http://' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>



<div id="fb-root"></div>
<script>(function(d, s, id) {
  var js, fjs = d.getElementsByTagName(s)[0];
  if (d.getElementById(id)) {return;}
  js = d.createElement(s); js.id = id;
  js.src = "//connect.facebook.net/en_US/all.js#appId=212934732101925&xfbml=1";
  fjs.parentNode.insertBefore(js, fjs);
}(document, 'script', 'facebook-jssdk'));</script>





  <script type="text/javascript">
    (function(){
      var twitterWidgets = document.createElement('script');
      twitterWidgets.type = 'text/javascript';
      twitterWidgets.async = true;
      twitterWidgets.src = 'http://platform.twitter.com/widgets.js';
      document.getElementsByTagName('head')[0].appendChild(twitterWidgets);
    })();
  </script>




</body>
</html>